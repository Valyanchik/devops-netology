
# Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения."

## Задача 1

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

Полная аппаратная виртуализация:  
-жесткое распределение ресурсов между ВМ посредством гипервизора 1-го рода (можно настраивать в гипервизоре   
-изоляция ВМ на уровне ядра гипервизора    
-Высокая производительность ВМ за счет прямого доступа к «железным ресурсам»   
-нет необходимости в дополнительных драйверах для гипервизора в большинстве случаев (иногда встречаются случаи, когда на новых версиях гипервизора нет по умолчанию драйвера какого-нибудь RAID контроллера)   
-возможность установки и настройки дополнительных модулей к гипервизору (например создание кластера серверов для балансировки или отказоустойчивости)   
-требует достаточно высокой квалификации и имеет высокий порог вхождения   
-настройка ВМ занимает больше всего времени   
-точкой отказа являются аппаратные неполадки     
Паравиртуализация:   
-жесткое распределение ресурсов между ВМ посредством гипервизора 2-го рода   
-изоляция ВМ на уровне ядра хостовой ОС, поверх которой гипервизор установлен   
-может возникнуть необходимость в установке на хостовую ОС дополнительного ПО для обеспечения возможности работы ВМ с железом хостовой ОС   
-меньшая производительность ВМ за счет того, что между ВМ и «железными ресурсами» есть «посредник» в виде хостовой ОС, от скорости работы которого будет зависеть скорость работы гостевых ОС (ВМ)   
-зачастую примитивный набор функций гипервизоров 2-го рода     
-дополнительных функций особо не становить к гипервизору, стандартного набора хватает, зачастую, для выполнения типовых задач (сервер БД, машина с РДП и т.д)   
-высокой квалификации в большинстве случаев не требует, т.к весь инструментарий доступен при помощи простого «создать\дале\далее\готово»    
-настройка необходимого набора ВМ займет меньше времени, чем при аналогичной настройке на полной аппаратной виртуализации    
-точкой отказа могут являться как неполадки железа так и программные неполадки хостовой ОС   
Виртуализация на основе ОС:   
-каждая ВМ может иметь полный доступ к аппаратным ресурсам без дополнительных настроек   
-ВМ не имеют собственного ядра и являются набором изолированных внутри хостовой ОС процессов   
-имеет высокий порог вхождения, однако при должной сноровке использование контейнеризации упрощает жизнь да и не всегда есть необходимость разворачивать целую ВМ для запуска веб-сервера или сервера БД для тестов или чего то подобного   
-точки отказа такие же, как и в паравиртуализации   
-производительность ВМ выше, чем у паравиртуализации, т.к между ресурсами и ВМ нет посредника в виде гипервизора 2-го рода  

## Задача 2

Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.
Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

Организация серверов:
- физические сервера,
- паравиртуализация,
- виртуализация уровня ОС.

Условия использования:
- Высоконагруженная база данных, чувствительная к отказу.  
полная виртуализация оптимальное решение, т.к можно настроить кластер серверов с балансировкой и зеркалированием, а так же обеспечить live migration  ВМ    
доступ БД к аппаратным ресурсам практически прямой, что ускоряет процедуры записи\чтения   

- Различные web-приложения.  
Подойдет виртуализация на основе ОС, ту-же балансировку можно настроить в контейнере, легко развернуть в контейнере  

- Windows системы для использования бухгалтерским отделом.  
Подойдет паравиртуализация (hyper-v как служба с mssql сервером на борту ВМ поверх Hyper-v достаточно частый выбор средних организаций, 1С с базой на 100ГБ при этом работает хорошо)    

- Системы, выполняющие высокопроизводительные расчеты на GPU.    
При таком раскладе предоставление ВМ практически пярмого доступа к  аппаратным ресурсам было бы оптимальным решением, поэтому подойдет полная виртуализация    



## Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
Подойдет полная виртуализация типа vmware:  
-удобный интерфейс управления ВМ (v-sphere)
-простота развертывания ВМ(можно настроить развертывание из образов)  
-возможность балансировки нагрузки между ВМ и live migration
-возможность делать РК как консольно так и при помощи стороннего ПО (acronis, veeam на отдельной ВМ)  

2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
proxmox подошел бы(Hyper-v и vmware бесплатных версий будут иметь ограничения в работе с аппаратными ресурсами и аппаратными юсб-токенами)  
-лаконичная и понятная консоль управления ВМ  
-возможность обеспечить программную отказоустойчивость в виде программны RAID  
-поддержка большого количества гостевых ОС

3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
Сложно сказать: у hyper-v есть бесплатная версия, имеющая ограничение на использование аппаратных ресурсов и не имеющае удобной консоли управления
Если рассмотреть вариант, что куплен windows-server с возможность утсановки роли hyper-v, То это было бы оптимальным решением, если нет - то подойдет proxmox (не работал с xen, но возможно он бы тоже подошел)  

4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.
Подойдет какой нибудь докер (написать универсальный скрипт для развертывания контейнера с  ПО)
Может так же сгодиться vagrant, как автоматизированное средство развертывания ВМ с необходимым ПО



## Задача 4

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

Гетерогенная инфраструктура – это неудобно, т.к необходимо разбираться в различных типах гипервизоров, читать в несколько раз больше документации и осваивать несколько технологий.  
В идеале, как по мне – все нужно приводить к единообразию и стандартизации, :так проще управлять системой, апгрейдить ее, масштабировать и документировать (сталкивался с случаем на одном предприятии, где был vmware vsphere и hyper-v как служба поверх win server, управлять этим зоопарком было не удобно, необходимость скакать между консолями, отсутствие балансировки нагрузки в hyper-v, различные способы РК ВМ, все это создавало неудобства, в итоге, переехав полностью на vmware сократилось число используемых инструментов и вся инфраструктура оказалась в одной интуитивно понятной консоли, РК значительно упростилось).

Единая консоль управления ВМ позволяет проще ориентироваться в окружении и управлять ресурсами системы, проводить инвентаризацию и апгрейд инфраструктуры.  
Так же недостатком гетерогенной структуры будет различный тип доступа ВМ к ресурсам: одни ВМ будут работать быстрее за счет практически прямого доступа к аппаратным ресурсам, другие же из-за посредника в виде гипервизора 2-го рода будут работать медленнее.  

Появляется больше точек отказа, т.к вылет гипервизора 1-го рода может повлечь за собой выход из строя нескольких гипервизоров второго рода или нескольких ВМ с виртуализацией на основе ОС, вылет хостовой ОС так-же может повлечь за собой выход из строя нескольких контейнеров.  

Однако, гетерогенная инфраструктура встречается регулярно в виде: крутой гипервизор типа vmware или hyper-v + контейнеры внутри ВМ. Процесс развертывания ВМ в таком случае может быть автоматизирован, после чего уже можно разворачивать изолированные приложения или функции в контейнерах и настраивать балансировку как между хостовыми ОС так и между контейнерными приложениями.  
